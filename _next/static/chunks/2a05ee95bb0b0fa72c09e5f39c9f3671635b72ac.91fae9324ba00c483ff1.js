(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[20],{Sw3N:function(e,t,r){"use strict";r.d(t,"b",(function(){return o}));var n=r("v0pa"),a="OB1DLNxfQdW5lXrjyIqzLQ";function o(e){var t=new URL("https://zoom.us/oauth/authorize");t.searchParams.append("response_type","code"),t.searchParams.append("client_id",a),t.searchParams.append("redirect_uri","".concat("https://localhost","/oauth/zoom"));var r=Object(n.a)(e);t.searchParams.append("state",JSON.stringify(r)),window.open(t.href,"_self")}t.a={oauth:o}},d63O:function(e,t,r){"use strict";var n=r("rePB"),a=r("ODXe"),o=r("UswH"),c=r("v0pa");function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){Object(n.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var u="https://auth.onin.dev/v1".startsWith("https://auth.onin.co"),p=["https://www.googleapis.com/auth/userinfo.email","https://www.googleapis.com/auth/userinfo.profile","https://www.googleapis.com/auth/calendar.readonly","https://www.googleapis.com/auth/calendar.events"];t.a={oauth:function(e){var t=e.prompt,r=void 0===t?"select_account":t,n=new URL("https://accounts.google.com/o/oauth2/v2/auth"),i=Object(o.b)()&&location.href.startsWith("http://localhost")?"https://onin.co":new URL(location.href).origin,l="".concat(i,"/oauth/google"),f=u?"551578160611-8du1dgq0e5tqhca9ssoajbctfngce22e.apps.googleusercontent.com":"854342882935-6o5vm77ihiphidsndrhqti72k5mjbkl8.apps.googleusercontent.com";if(u&&l.startsWith("http://localhost"))throw new Error("Google does not allow production apps to redirect to localhost. Try editing /etc/hosts");for(var h={response_type:"code",client_id:f,redirect_uri:l,scope:p.join(" "),access_type:"offline",prompt:r},d=0,b=Object.entries(h);d<b.length;d++){var g=Object(a.a)(b[d],2),m=g[0],v=g[1];n.searchParams.append(m,v)}var O=s(s({},Object(c.a)(e)),{},{redirectUrl:l});n.searchParams.append("state",JSON.stringify(O)),window.open(n.href,"_self")}}},lvAx:function(e,t,r){"use strict";r.d(t,"a",(function(){return T}));var n=r("ODXe"),a=r("o0o1"),o=r.n(a),c=r("rePB"),i=r("HaE+"),s=r("sVgz"),u=r("FrBo"),p=r("FO7x"),l=r("rtU3"),f=r("vDqi"),h=r.n(f),d=r("20a2"),b=r.n(d),g=r("q1tI"),m=r.n(g),v=r("+3t5"),O=r("lqXm"),y=r("UswH"),w=r("pq+A"),j=r("gftI"),x=r("ZKk5"),k=r("9MT2"),P=r("v0pa"),_=m.a.createElement;function N(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function I(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?N(Object(r),!0).forEach((function(t){Object(c.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var S="\n  text-align: center;\n  display: block;\n  border-radius: 8px;\n  height: 44px;\n  margin-bottom: 16px;\n  text-align: center;\n  border: 0;\n",D=l.c.a.withConfig({displayName:"InterstitialAuth__LoginLink",componentId:"sc-17g4n9v-0"})([""," line-height:44px;vertical-align:middle;background-color:grey2;color:white;"],S),C=l.c.button.withConfig({displayName:"InterstitialAuth__LoginButton",componentId:"sc-17g4n9v-1"})([""," background-color:grey9;color:black;"],S),A=l.c.div.withConfig({displayName:"InterstitialAuth__ButtonContainer",componentId:"sc-17g4n9v-2"})(["display:flex;flex-direction:column;justify-content:flex-end;h1{font-size:24px;letter-spacing:-0.02em;max-width:233px;}"]),E=l.c.section.withConfig({displayName:"InterstitialAuth__MainContainer",componentId:"sc-17g4n9v-3"})(["display:flex;flex-direction:column;justify-content:space-between;padding:16px 16px 0 16px;",""],(function(){return Object(l.b)(["height:",";"],"".concat(window.innerHeight))})),L=l.c.div.withConfig({displayName:"InterstitialAuth__LogoContainer",componentId:"sc-17g4n9v-4"})(["justify-self:flex-start;"]),U=function(e){try{return JSON.parse(e)}catch(t){console.log("Failed to parse json::: ".concat(t))}},q=function(){var e=Object(i.a)(o.a.mark((function e(t){var r,n,a,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.provider,n=t.error,a=t.state,n=Array.isArray(n)?n[0]:n,a=Array.isArray(a)?a[0]:a,e.t0=n,e.next="interaction_required"===e.t0?6:"access_denied"===e.t0?16:18;break;case 6:c={},e.prev=7,c=JSON.parse(a),e.next=15;break;case 11:return e.prev=11,e.t1=e.catch(7),console.log("failed to parse state"),e.abrupt("return");case 15:return e.abrupt("return",P.b[r](I({prompt:"consent"},c)));case 16:return b.a.push("/error?code=ACCESS_DENIED"),e.abrupt("return");case 18:return b.a.push("/sign-up-and-login"),e.abrupt("return");case 20:case"end":return e.stop()}}),e,null,[[7,11]])})));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=Object(i.a)(o.a.mark((function e(t){var r,n,a,c,i,s,p,l,f,d,g,m,v,O,y,w,j;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.code,n=t.state,a=t.provider,e.prev=1,c=Array.isArray(r)?r[0]:r,i=Array.isArray(n)?n[0]:n,s=Array.isArray(a)?a[0]:a,e.next=7,h.a.request({method:"GET",url:"".concat("https://auth.onin.dev/v1","/").concat(s,"?code=").concat(c,"&state=").concat(n&&encodeURIComponent(i))});case 7:if(401!==(p=e.sent).status){e.next=12;break}return l=p.data,f=l.givenName,d=l.familyName,g=l.email,b.a.push("/welcome?givenName=".concat(f,"&familyName=").concat(d,"&email=").concat(g)),e.abrupt("return");case 12:if(p.data){e.next=15;break}return b.a.push("/error"),e.abrupt("return");case 15:p.data.token&&Object(u.i)(p.data.token),(m=U(i))&&null!==m&&void 0!==m&&m.route?b.a.push(null===m||void 0===m?void 0:m.route):b.a.push("/"),e.next=30;break;case 20:if(e.prev=20,e.t0=e.catch(1),!e.t0.message.includes("401")){e.next=27;break}return v="/welcome",e.t0.response.data&&(O=e.t0.response.data,y=O.givenName,w=O.familyName,j=O.email,v+="?givenName=".concat(y,"&familyName=").concat(w,"&email=").concat(j)),b.a.push(v),e.abrupt("return");case 27:return console.log(e.t0),b.a.push("/error"),e.abrupt("return");case 30:case"end":return e.stop()}}),e,null,[[1,20]])})));return function(t){return e.apply(this,arguments)}}(),W=l.c.div.withConfig({displayName:"InterstitialAuth__SpinnerContainer",componentId:"sc-17g4n9v-5"})(["height:100vh;display:flex;justify-content:center;align-items:center;svg{transform:translateY(-50%);}"]);function z(){return _(W,null,_(k.a,{loading:!0,dark:!0,size:96}))}var T=Object(j.a)((function(){var e=Object(w.c)(),t=e.query,r=void 0===t?{}:t,a=e.query,c=a.token,u=a.code,l=void 0===u?"":u,f=a.state,h=void 0===f?"":f,d=a.error,b=void 0===d?"":d,m=(a.error_subtype,e.path),j=e.asPath,k=Object(g.useState)(null),P=k[0],N=k[1],I=Object(p.a)((function(e){return e.invite.setInvite})),S=Object(g.useCallback)(Object(i.a)(o.a.mark((function e(){var t,a,i,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=location.pathname.startsWith("/oauth/google")?"google":location.pathname.startsWith("/oauth/zoom")?"zoom":location.pathname.startsWith("/oauth/microsoft")?"microsoft":location.pathname.startsWith("/oauth/test")?"test":void 0,a=Object(n.a)(m,3),i=a[1],s=a[2],!c){e.next=7;break}return e.next=5,Object(O.a)(c,r,m);case 5:e.next=20;break;case 7:if("join"!==i){e.next=12;break}return e.next=10,Object(v.a)(s,I);case 10:e.next=20;break;case 12:if(!t){e.next=20;break}if(N("loading"),!t||!l){e.next=17;break}return e.next=17,R({code:l,state:h,provider:t});case 17:if("microsoft"!==t&&"google"!==t||!b){e.next=20;break}return e.next=20,q({provider:t,error:b,state:h});case 20:case"end":return e.stop()}}),e)}))),[c,r,m,l,h,j,I]);Object(g.useEffect)((function(){Object(s.a)()&&!Object(y.b)()?N("prompt"):S()}),[S]);var U=new URL("https://open.onin.co".concat(j)),W=_(E,null,_(L,null,_(x.a,null)),_(A,null,_("h1",null,"Where do you want to login?"),_(D,{href:U.href},"In the Onin app"),_(C,{onClick:function(){return S()}},"In this browser"))),T="prompt"===P;return"loading"===P?_(z,null):T?W:null}))},v0pa:function(e,t,r){"use strict";r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return m}));var n=r("rePB"),a=r("UswH"),o=r("pa7U"),c=r("d63O"),i=r("xLyN"),s=r("ZijK"),u=r("+GTU"),p=function(){if(Object(u.a)()){var e=localStorage.getItem("cy-test-auth-enabled");return e?JSON.parse(e):void 0}};var l={oauth:function(e){var t=p();Object(s.a)(null===t||void 0===t?void 0:t.code,"missing testing mode",{testingState:t});var r=b(e),n=new URL(location.origin);n.pathname="/oauth/test",n.searchParams.append("code",t.code),n.searchParams.append("state",JSON.stringify(r)),location.href=n.toString()}},f=r("Sw3N");function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){Object(n.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var b=function(e){var t=e.inviteToken,r=e.linkToken,n=e.route,c=e.setSyncPreference,i=e.syncIntegration,s=e.skipWaitList,u=void 0===s?void 0:s;return d(d(d(d(d(d({deviceUDID:Object(o.b)(),appPlatform:"apps-web",isReactNative:Object(a.b)()},t&&{inviteToken:t}),r&&{linkToken:r}),n&&{route:n}),c&&{setSyncPreference:c}),i&&{syncIntegration:i}),u&&{skipWaitList:u})},g=function(e){return function(t){return Boolean(p())?l.oauth(t):e(t)}},m={microsoft:g(i.a.oauth),google:g(c.a.oauth),zoom:g(f.a.oauth)}},xLyN:function(e,t,r){"use strict";(function(e){var n=r("ODXe"),a=r("v0pa"),o=e.env.MICROSOFT_CLIENT_ID||"3d6c20b3-57fa-4f6b-a1cd-e1e4e19c3605",c=["openid","email","profile","Calendars.ReadWrite","Calendars.Read","Calendars.Read.Shared","offline_access","User.Read"].join(" ");t.a={oauth:function(e){if(o){for(var t=new URL("https://login.microsoftonline.com/common/oauth2/v2.0/authorize"),r={response_type:"code",client_id:o,redirect_uri:"".concat("https://localhost","/oauth/microsoft"),response_mode:"query",scope:c,prompt:"login"},i=0,s=Object.entries(r);i<s.length;i++){var u=Object(n.a)(s[i],2),p=u[0],l=u[1];t.searchParams.append(p,l)}var f=Object(a.a)(e);t.searchParams.append("state",JSON.stringify(f)),window.open(t.href,"_self")}else console.log("microsoft client id not set")}}}).call(this,r("8oxB"))}}]);